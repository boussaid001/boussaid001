# Advanced GitHub Profile Animations - BMA Brand
# Generates advanced animations: Snake and 3D Contribution Graph

name: ðŸŽ¨ Generate Advanced Profile Animations

on:
  # Schedule to run automatically every 6 hours for fresh animations
  schedule:
    - cron: "0 */6 * * *"
  
  # Manual trigger from Actions tab
  workflow_dispatch:
  
  # Run on push to main
  push:
    branches:
      - main

permissions:
  contents: write

jobs:
  generate-animations:
    runs-on: ubuntu-latest
    timeout-minutes: 10
    
    steps:
      # Checkout repository with full history
      - name: ðŸ“¥ Checkout repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      # Create output directories
      - name: ðŸ“ Create output directories
        run: |
          mkdir -p dist
          mkdir -p profile-3d-contrib

      # ============================================
      # 1. SNAKE ANIMATION
      # ============================================
      - name: ðŸ Generate Snake Animation
        uses: Platane/snk@master
        with:
          github_user_name: Boussaid001
          outputs: |
            dist/github-contribution-grid-snake.svg
            dist/github-contribution-grid-snake-dark.svg?palette=github-dark
            dist/github-contribution-grid-snake.gif?color_snake=orange&color_dots=#bfd6f6,#8dbdff,#64a1f4,#4b91f1,#3c7dd9
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      # ============================================
      # 2. 3D CONTRIBUTION GRAPH
      # ============================================
      - name: ðŸŽ¯ Generate 3D Contribution Graph
        uses: yoshi389111/github-profile-3d-contrib@latest
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          USERNAME: Boussaid001

      # ============================================
      # 3. COPY BMA BRAND IMAGE
      # ============================================
      - name: ðŸŽ¨ Copy BMA Brand Image
        run: |
          if [ -f "BMA.png" ]; then
            cp BMA.png dist/bma-brand.png
            echo "âœ… BMA brand image copied successfully"
          else
            echo "âš ï¸  BMA.png not found, skipping brand image copy"
          fi

      # ============================================
      # 4. SHOW GENERATED FILES
      # ============================================
      - name: ðŸ“Š Show generated files
        run: |
          echo "ðŸ“ Generated files:"
          find dist -type f 2>/dev/null | head -20 || true
          find profile-3d-contrib -type f 2>/dev/null | head -10 || true
          echo ""
          echo "âœ… Animation generation complete!"

      # ============================================
      # 5. ORGANIZE 3D GRAPH FILES
      # ============================================
      - name: ðŸ“¦ Organize 3D graph files
        run: |
          if [ -d "profile-3d-contrib" ]; then
            cp -r profile-3d-contrib dist/ || true
            echo "âœ… 3D graph files organized"
          fi

      # ============================================
      # 6. COMMIT AND PUSH TO OUTPUT BRANCH
      # ============================================
      - name: ðŸš€ Deploy to output branch
        uses: crazy-max/ghaction-github-pages@v4
        with:
          target_branch: output
          build_dir: dist
          keep_history: true
          allow_empty_commit: true
          commit_message: |
            ðŸŽ¨ Update advanced profile animations
            - Primary snake animation
            - 3D contribution graph
            - BMA brand integration
            [skip ci]
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

